#!/bin/bash

mkdir -p ~/.local/bin

if ! [ -x ~/.local/bin/uv ]; then
  UV_NO_MODIFY_PATH=1 UV_INSTALL_DIR="$HOME/.local/bin" ~/.local/bin/uv-installer
fi

if ! [ -x ~/.local/bin/xonsh ]; then
  ~/.local/bin/uv tool install "xonsh[full]" --with pip
fi

if ! [ -x ~/.local/bin/black ]; then
  ~/.local/bin/uv tool install black
fi

if ! [ -x ~/.local/bin/isort ]; then
  ~/.local/bin/uv tool install isort
fi

if ! [ -x ~/.local/bin/ipython ]; then
  ~/.local/bin/uv tool install ipython --with pip
fi

if ! [ -x ~/.local/bin/yt-dlp ]; then
  ~/.local/bin/uv tool install yt-dlp[default]
fi

# Originally had this as a python venv, but switched to use magic-wormhole-rs as a static binary
#if ! [ -x ~/.local/bin/wormhole ]; then
#  # On armv7 systems, wheels for pynacl aren't available, so we need to use the system libsodium
#  {{ if eq .chezmoi.arch "arm" }}SODIUM_INSTALL=system{{ end }} ~/.local/bin/uv tool install magic-wormhole
#fi

if ! [ -x ~/.local/bin/xlsx2csv ]; then
  ~/.local/bin/uv tool install xlsx2csv
fi
